{% extends 'layout.html' %}

{% block title %}Split PDF{% endblock %}

{% block content %}
    <h2 class="mb-4">Split PDF File</h2>

    <div class="card mb-4">
        <div class="card-body">
            <p class="card-text">Upload a PDF file to split it into multiple documents.</p>
            <div id="drop-zone" class="drop-zone border border-dashed rounded p-4 text-center mb-3">
                <p class="mb-0">Drag & Drop PDF here or Click to Browse</p>
                <input type="file" id="file-input" accept=".pdf" style="display: none;">
            </div>

            <div id="file-info-container" class="mb-3" style="display: none;">
                <h5>Selected File: <span id="selected-file-name"></span></h5>
                <p>Total Pages: <span id="total-pages"></span></p>
            </div>

            <div id="split-options" class="mb-3" style="display: none;">
                <h5>Split Options:</h5>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="splitOption" id="splitAllPages" value="all_pages" checked>
                    <label class="form-check-label" for="splitAllPages">
                        Split all pages into individual PDFs
                    </label>
                </div>
                <div class="form-check mb-3">
                    <input class="form-check-input" type="radio" name="splitOption" id="splitCustomRanges" value="custom_ranges">
                    <label class="form-check-label" for="splitCustomRanges">
                        Split by custom page ranges (e.g., 1-3, 5, 7-9)
                    </label>
                </div>
                <div id="page-ranges-input" class="mb-3" style="display: none;">
                    <label for="pageRanges" class="form-label">Page Ranges:</label>
                    <input type="text" class="form-control" id="pageRanges" placeholder="e.g., 1-3, 5, 7-9">
                    <div class="form-text">Enter page numbers or ranges separated by commas.</div>
                </div>
            </div>

            <div id="captcha-area" class="mb-3" style="display: none;">
                <label for="captcha-input" class="form-label fw-bold" id="captcha-question">Loading CAPTCHA...</label>
                <input type="text" id="captcha-input" class="form-control" placeholder="Please solve the math problem">
            </div>

            <button id="split-btn" class="btn btn-primary" disabled>Split PDF</button>

            <div id="progress-area" class="mt-4" style="display: none;">
                <div class="progress">
                    <div id="split-progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <p class="text-center mt-2" id="progress-text">Splitting your PDF...</p>
            </div>

            <div id="download-area" class="mt-4" style="display: none;">
                <div class="alert alert-success" role="alert">
                    PDF split successfully! Download your files:
                </div>
                <ul id="download-links-list" class="list-group">
                    <!-- Download links will be added here by JavaScript -->
                </ul>
            </div>

            <div id="error-area" class="mt-4" style="display: none;">
                <div class="alert alert-danger" role="alert">
                    <span id="error-message"></span>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/split.js') }}"></script>
{% endblock %}
